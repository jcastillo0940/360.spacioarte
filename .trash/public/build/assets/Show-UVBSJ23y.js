import{r as l,j as e,H as c,L as n}from"./app-OZZRvyqe.js";import{A as d}from"./AuthenticatedLayout-D2-JfW7j.js";import{C as v}from"./circle-alert-BwVHk0SL.js";import{A as S}from"./arrow-left-De8lAmq5.js";import{P as I}from"./printer-D6ZKel5f.js";import{C as b}from"./circle-check-big-DwnsnTu7.js";import{C as w}from"./circle-x-BVUVpMCC.js";import{U as L}from"./user-B0JuJe4v.js";import{C as T}from"./calendar-CVAC3eWB.js";import{D as C}from"./dollar-sign-DA8LgLRo.js";import{F as k}from"./file-text-RP8-UYCr.js";import{P as E}from"./package-fEtEZ-xE.js";import"./createLucideIcon-Dvcv2Uye.js";function Q({auth:i,notaId:o}){var x,m,h,p,g,j,u,N;const[s,F]=l.useState(null),[A,P]=l.useState(!0);l.useEffect(()=>{_()},[o]);const _=async()=>{try{const r=await(await fetch(`/api/ventas/notas-credito/${o}`)).json();F(r)}catch(t){console.error("Error al cargar nota de crédito:",t)}finally{P(!1)}},$=t=>{const r={devolucion:{color:"text-blue-600",bgColor:"bg-blue-100",icon:E,label:"Devolución de Producto",descripcion:"El cliente devolvió el producto físicamente"},merma:{color:"text-red-600",bgColor:"bg-red-100",icon:v,label:"Merma / Producto Dañado",descripcion:"Producto no regresó al inventario"},descuento:{color:"text-green-600",bgColor:"bg-green-100",icon:C,label:"Descuento / Ajuste de Precio",descripcion:"Ajuste sin movimiento físico de inventario"}};return r[t]||r.devolucion};if(A)return e.jsxs(d,{user:i.user,children:[e.jsx(c,{title:"Detalle Nota de Crédito"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})})})})]});if(!s)return e.jsxs(d,{user:i.user,children:[e.jsx(c,{title:"Nota de Crédito no encontrada"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Nota de Crédito no encontrada"}),e.jsx(n,{href:"/ventas/notas-credito",className:"text-indigo-600 hover:underline",children:"Volver al listado"})]})})})]});const a=$(s.tipo_nota),D=a.icon;return e.jsxs(d,{user:i.user,children:[e.jsx(c,{title:`Nota de Crédito ${s.numero_nota}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(n,{href:"/ventas/notas-credito",className:"inline-flex items-center text-indigo-600 hover:text-indigo-800 mb-4",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Volver al listado"]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Nota de Crédito ",s.numero_nota]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Factura de referencia: ",(x=s.factura)==null?void 0:x.numero_factura]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>window.print(),className:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition",children:[e.jsx(I,{className:"w-5 h-5 mr-2"}),"Imprimir"]}),s.estado==="Activa"&&e.jsxs("span",{className:"inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-lg",children:[e.jsx(b,{className:"w-5 h-5 mr-2"}),"Activa"]}),s.estado==="Anulada"&&e.jsxs("span",{className:"inline-flex items-center px-4 py-2 bg-red-100 text-red-800 rounded-lg",children:[e.jsx(w,{className:"w-5 h-5 mr-2"}),"Anulada"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:`${a.bgColor} rounded-lg p-6`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(D,{className:`w-8 h-8 ${a.color} mr-4`}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-bold ${a.color}`,children:a.label}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:a.descripcion}),e.jsxs("div",{className:"mt-3 p-3 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Motivo:"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:s.motivo})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Productos Incluidos"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Producto"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cantidad"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Precio Unit."}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Inventario"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(m=s.detalles)==null?void 0:m.map((t,r)=>{var f,y;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:(f=t.item)==null?void 0:f.nombre}),e.jsx("p",{className:"text-xs text-gray-500",children:(y=t.item)==null?void 0:y.codigo})]})}),e.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-900",children:parseFloat(t.cantidad).toFixed(2)}),e.jsxs("td",{className:"px-6 py-4 text-right text-sm text-gray-900",children:["$",parseFloat(t.precio_unitario).toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 text-center",children:t.devuelto_stock?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:[e.jsx(b,{className:"w-3 h-3 mr-1"}),"Devuelto"]}):e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:[e.jsx(w,{className:"w-3 h-3 mr-1"}),"No devuelto"]})}),e.jsxs("td",{className:"px-6 py-4 text-right text-sm font-medium text-gray-900",children:["$",parseFloat(t.total_item).toFixed(2)]})]},r)})})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(L,{className:"w-5 h-5 mr-2 text-gray-600"}),"Cliente"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Razón Social"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:(p=(h=s.factura)==null?void 0:h.cliente)==null?void 0:p.razon_social})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"RUC/Identificación"}),e.jsx("p",{className:"text-sm text-gray-900",children:(j=(g=s.factura)==null?void 0:g.cliente)==null?void 0:j.identificacion})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(T,{className:"w-5 h-5 mr-2 text-gray-600"}),"Fechas"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Fecha de Emisión"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(s.fecha).toLocaleDateString("es-PA",{year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Hora"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(s.fecha).toLocaleTimeString("es-PA")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(C,{className:"w-5 h-5 mr-2 text-gray-600"}),"Resumen Financiero"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",parseFloat(s.subtotal).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ITBMS"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",parseFloat(s.itbms_total).toFixed(2)]})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-base font-bold text-gray-900",children:"Total"}),e.jsxs("span",{className:"text-base font-bold text-indigo-600",children:["$",parseFloat(s.total).toFixed(2)]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(k,{className:"w-5 h-5 mr-2 text-gray-600"}),"Factura Original"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Número"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:(u=s.factura)==null?void 0:u.numero_factura})]}),e.jsx(n,{href:`/ventas/facturas/${(N=s.factura)==null?void 0:N.id}`,className:"block w-full text-center px-4 py-2 bg-indigo-50 text-indigo-700 rounded-lg hover:bg-indigo-100 transition text-sm font-medium",children:"Ver Factura Original"})]})]})]})]})]})})]})}export{Q as default};
