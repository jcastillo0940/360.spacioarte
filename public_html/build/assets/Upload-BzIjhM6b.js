import{r as l,j as e,H as R,b as y}from"./app-B9gv8ZBn.js";import{A as z}from"./AuthenticatedLayout-BtVr5BZh.js";import{S as E}from"./search-BmZ71YM3.js";import{C as I}from"./circle-x-C-wfysMX.js";import{C as B}from"./circle-check-big-DI7VEtmR.js";import{T as F}from"./triangle-alert-8Sla9pk1.js";import{F as k}from"./file-text-giW9wa2H.js";import{U as O}from"./upload-7iKC3RfR.js";import"./createLucideIcon-CS3OZA2G.js";function G(){const[c,S]=l.useState(""),[s,x]=l.useState(null),[p,u]=l.useState(!1),[b,n]=l.useState(null),[o,m]=l.useState(null),[d,h]=l.useState(null),[g,f]=l.useState(""),[j,N]=l.useState(!1),[C,v]=l.useState(!1),w=async a=>{var t,i;if(a&&a.preventDefault(),!!c){u(!0),n(null),x(null),v(!1);try{const r=await y.get(`/api/diseno/search?q=${c}`);x(r.data)}catch(r){n(((i=(t=r.response)==null?void 0:t.data)==null?void 0:i.error)||"No se encontró la orden especificada.")}finally{u(!1)}}},_=a=>{const t=a.target.files[0];t&&(m(t),h(URL.createObjectURL(t)))},D=async a=>{var i,r;if(a.preventDefault(),!o||!s)return;N(!0),n(null);const t=new FormData;t.append("numero_orden",s.numero_orden),t.append("imagen",o),t.append("comentarios",g);try{await y.post("/api/diseno/upload",t,{headers:{"Content-Type":"multipart/form-data"}}),v(!0),m(null),h(null),f(""),w()}catch(A){n(((r=(i=A.response)==null?void 0:i.data)==null?void 0:r.error)||"Error al subir el diseño.")}finally{N(!1)}};return e.jsxs(z,{children:[e.jsx(R,{title:"Carga de Diseño"}),e.jsxs("div",{className:"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tighter italic",children:"CARGA DE DISEÑO"}),e.jsx("p",{className:"text-slate-500 font-bold text-xs uppercase tracking-widest",children:"Módulo de Pre-Prensa y Diseño"})]}),e.jsx("div",{className:"bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100 p-6",children:e.jsxs("form",{onSubmit:w,className:"flex gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(E,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:20}),e.jsx("input",{type:"text",value:c,onChange:a=>S(a.target.value),placeholder:"Escanea QR o escribe número de orden...",className:"w-full pl-12 pr-4 py-4 rounded-2xl bg-slate-50 border-none focus:ring-2 focus:ring-blue-600 font-bold text-slate-800"})]}),e.jsx("button",{type:"submit",disabled:p,className:"bg-slate-900 text-white px-8 rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-black transition-all active:scale-95 disabled:opacity-50",children:p?"Buscando...":"Buscar"})]})}),b&&e.jsxs("div",{className:"bg-red-50 border border-red-100 text-red-600 p-4 rounded-2xl flex items-center gap-3 animate-shake",children:[e.jsx(I,{size:20}),e.jsx("span",{className:"text-xs font-black uppercase tracking-tight",children:b})]}),C&&e.jsxs("div",{className:"bg-green-50 border border-green-100 text-green-600 p-4 rounded-2xl flex items-center gap-3 animate-bounce-short",children:[e.jsx(B,{size:20}),e.jsx("span",{className:"text-xs font-black uppercase tracking-tight",children:"¡Diseño enviado correctamente al cliente!"})]}),s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-white rounded-3xl border border-slate-100 p-6 space-y-6 flex flex-col justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-slate-900 italic",children:["#",s.numero_orden]}),e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase",children:s.cliente})]}),e.jsx("span",{className:`px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest ${s.estado_diseno==="Aprobado"?"bg-green-100 text-green-600":s.estado_diseno==="Rechazado"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:s.estado_diseno})]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl border border-slate-100",children:e.jsx(F,{size:20,className:"text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest leading-none",children:"Vez Subida"}),e.jsxs("p",{className:"font-black text-lg text-slate-800",children:[s.intentos," veces"]})]})]}),e.jsx("span",{className:"text-[10px] font-black text-slate-400",children:"Diseño Real Realizado"})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-100 p-4 rounded-2xl space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-blue-600 uppercase tracking-widest mb-1 italic",children:"Detalle Interno (Ventas)"}),e.jsx("p",{className:"text-xs font-bold text-blue-900 bg-white/50 p-2 rounded-lg",children:s.detalle_diseno||"Sin detalles adicionales"})]}),s.brief_cliente&&e.jsxs("div",{className:"pt-2 border-t border-blue-100",children:[e.jsx("p",{className:"text-[9px] font-black text-indigo-600 uppercase tracking-widest mb-1 italic",children:"Brief del Cliente"}),e.jsx("p",{className:"text-xs font-bold text-indigo-900 bg-white/50 p-2 rounded-lg",children:s.brief_cliente}),s.archivo_brief_path&&e.jsxs("a",{href:s.archivo_brief_path,target:"_blank",className:"mt-2 inline-flex items-center gap-1 text-[10px] font-black text-indigo-600 hover:text-indigo-800 uppercase tracking-tighter",children:[e.jsx(k,{size:12})," Descargar Archivo Cliente"]})]})]})]}),e.jsx("div",{className:"bg-white rounded-3xl border border-slate-100 p-6 shadow-xl shadow-blue-900/5",children:e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Seleccionar Archivo (Imagen)"}),e.jsxs("label",{className:`w-full h-40 border-2 border-dashed rounded-3xl flex flex-col items-center justify-center gap-2 cursor-pointer transition-all ${d?"border-blue-500 bg-blue-50/20":"border-slate-200 hover:border-blue-400 hover:bg-slate-50"}`,children:[d?e.jsx("img",{src:d,className:"h-full w-full object-contain p-4 rounded-3xl"}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:32,className:"text-slate-300"}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Haz clic para subir imagen"})]}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:_})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Comentarios para el Cliente"}),e.jsx("textarea",{value:g,onChange:a=>f(a.target.value),placeholder:"Ej: Se ajustaron colores según referencia...",className:"w-full bg-slate-50 border-none rounded-2xl p-4 text-xs font-bold focus:ring-2 focus:ring-blue-600 h-24"})]}),e.jsx("button",{type:"submit",disabled:!o||j||s.estado_diseno==="Aprobado",className:"w-full bg-blue-600 text-white py-4 rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-blue-700 transition-all shadow-lg shadow-blue-600/20 disabled:opacity-50",children:j?"SUBIENDO...":"ENVIAR DISEÑO PARA APROBACIÓN"})]})})]}),s&&e.jsxs("div",{className:"bg-white rounded-3xl border border-slate-100 p-6",children:[e.jsxs("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(k,{size:14})," Historial de Revisiones"]}),e.jsx("div",{className:"space-y-3 opacity-50 grayscale italic text-[10px] font-bold py-10 text-center",children:"Próximamente: Historial de comentarios del cliente aparecerá aquí."})]})]})]})}export{G as default};
