import{r as n,j as e,H as d,L as l}from"./app-3DoqhR_o.js";import{A as o}from"./AuthenticatedLayout-314zbiSn.js";function N({facturaId:c}){var x,h,m;const[t,j]=n.useState(null),[b,i]=n.useState(!0);n.useEffect(()=>{fetch(`/api/compras/facturas/${c}`).then(s=>s.json()).then(s=>{j(s),i(!1)}).catch(s=>{console.error("Error loading factura:",s),i(!1)})},[c]);const a=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),f=s=>{const r={Abierta:"bg-orange-100 text-orange-700",Pagada:"bg-green-100 text-green-700",Anulada:"bg-red-100 text-red-700"};return r[s]||r.Abierta};return b?e.jsxs(o,{children:[e.jsx(d,{title:"Cargando..."}),e.jsx("div",{className:"max-w-5xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"text-slate-600 mt-4",children:"Cargando factura..."})]})})]}):t?e.jsxs(o,{children:[e.jsx(d,{title:`Factura ${t.numero_factura_proveedor}`}),e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(l,{href:"/compras/facturas",className:"text-slate-600 hover:text-slate-900 flex items-center gap-2 mb-4",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Volver a facturas"]}),e.jsx("h1",{className:"text-3xl font-black text-slate-900",children:"Factura de Compra"}),e.jsx("p",{className:"text-slate-600 mt-2 font-mono text-2xl font-bold",children:t.numero_factura_proveedor})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("a",{href:`/compras/facturas/${t.id}/pdf`,target:"_blank",className:"px-6 py-3 bg-red-600 text-white rounded-lg font-bold hover:bg-red-700 transition flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Descargar PDF"]}),t.estado==="Abierta"&&e.jsxs(l,{href:`/compras/pagos/crear?factura=${t.id}`,className:"px-6 py-3 bg-green-600 text-white rounded-lg font-bold hover:bg-green-700 transition flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Registrar Pago"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Información del Proveedor"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-bold text-slate-500",children:"Razón Social:"}),e.jsx("p",{className:"text-slate-900 font-bold",children:(x=t.proveedor)==null?void 0:x.razon_social})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-bold text-slate-500",children:"RUC:"}),e.jsx("p",{className:"text-slate-900 font-mono",children:(h=t.proveedor)==null?void 0:h.identificacion})]}),t.orden_original&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-bold text-slate-500",children:"Orden de Compra:"}),e.jsx(l,{href:`/compras/ordenes/${t.orden_original.id}`,className:"text-blue-600 hover:underline font-mono",children:t.orden_original.numero_orden})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-bold ${f(t.estado)}`,children:t.estado}),e.jsxs("div",{className:"mt-4 space-y-1",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Fecha Emisión:"}),e.jsx("div",{className:"font-bold text-slate-900",children:new Date(t.fecha_emision).toLocaleDateString("es-PA")})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Fecha Vencimiento:"}),e.jsx("div",{className:"font-bold text-slate-900",children:new Date(t.fecha_vencimiento).toLocaleDateString("es-PA")})]})]})]}),t.estado==="Abierta"&&parseFloat(t.saldo_pendiente)>0&&e.jsx("div",{className:"pt-4 border-t border-slate-200 bg-red-50 -m-6 p-6 mt-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-red-600",children:"Saldo Pendiente"}),e.jsx("div",{className:"text-3xl font-black text-red-700",children:a(t.saldo_pendiente)})]}),e.jsx(l,{href:`/compras/pagos/crear?factura=${t.id}`,className:"px-6 py-3 bg-red-600 text-white rounded-lg font-bold hover:bg-red-700 transition",children:"Pagar Ahora"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 bg-slate-50 border-b border-slate-200",children:e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Detalles de la Factura"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold uppercase text-slate-600",children:"Producto"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-bold uppercase text-slate-600",children:"Cantidad"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-bold uppercase text-slate-600",children:"Costo Unit."}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-bold uppercase text-slate-600",children:"Subtotal"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-bold uppercase text-slate-600",children:"ITBMS"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-bold uppercase text-slate-600",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:(m=t.detalles)==null?void 0:m.map(s=>{var r,p;return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-slate-900",children:(r=s.item)==null?void 0:r.nombre}),e.jsx("div",{className:"text-sm text-slate-500 font-mono",children:(p=s.item)==null?void 0:p.codigo})]}),e.jsx("td",{className:"px-6 py-4 text-center font-bold text-slate-900",children:s.cantidad}),e.jsx("td",{className:"px-6 py-4 text-right text-slate-600",children:a(s.costo_unitario)}),e.jsx("td",{className:"px-6 py-4 text-right text-slate-600",children:a(s.subtotal)}),e.jsxs("td",{className:"px-6 py-4 text-right text-slate-600",children:[a(s.monto_itbms),e.jsxs("div",{className:"text-xs text-slate-500",children:["(",s.tasa_itbms,"%)"]})]}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-green-600",children:a(s.total)})]},s.id)})}),e.jsxs("tfoot",{className:"bg-slate-900 text-white",children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:"3",className:"px-6 py-3 text-right font-bold",children:"Subtotal:"}),e.jsx("td",{className:"px-6 py-3 text-right font-bold",children:a(t.subtotal)}),e.jsx("td",{colSpan:"2"})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:"3",className:"px-6 py-3 text-right font-bold",children:"ITBMS Total:"}),e.jsx("td",{className:"px-6 py-3 text-right font-bold",children:a(t.itbms_total)}),e.jsx("td",{colSpan:"2"})]}),e.jsxs("tr",{className:"bg-slate-950",children:[e.jsx("td",{colSpan:"3",className:"px-6 py-4 text-right font-bold text-lg uppercase",children:"Total:"}),e.jsx("td",{colSpan:"3",className:"px-6 py-4 text-right font-black text-2xl",children:a(t.total)})]})]})]})})]})]})]}):e.jsxs(o,{children:[e.jsx(d,{title:"Error"}),e.jsx("div",{className:"max-w-5xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-12 text-center",children:[e.jsx("p",{className:"text-red-600 font-bold",children:"Factura no encontrada"}),e.jsx(l,{href:"/compras/facturas",className:"text-blue-600 mt-4 inline-block",children:"Volver"})]})})]})}export{N as default};
