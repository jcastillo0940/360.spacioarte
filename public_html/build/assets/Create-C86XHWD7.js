import{u as f,j as e,H as j}from"./app-BfpvEa9J.js";import{A as N}from"./AuthenticatedLayout-BAkMyy8i.js";function y({auth:u,facturas:r=[],bancos:p=[]}){const{data:s,setData:l,post:m,processing:i,errors:o}=f({facturas_ids:[],bank_account_id:"",monto_total:0,fecha_pago:new Date().toISOString().split("T")[0],metodo_pago:"Transferencia",referencia:""}),x=(t,d)=>{let c=s.facturas_ids.includes(t)?s.facturas_ids.filter(a=>a!==t):[...s.facturas_ids,t];const b=r.filter(a=>c.includes(a.id)).reduce((a,g)=>a+parseFloat(g.saldo_pendiente),0);l(a=>({...a,facturas_ids:c,monto_total:b.toFixed(2)}))},n=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0),h=t=>{t.preventDefault(),m(route("cobros.store"))};return e.jsxs(N,{user:u.user,header:e.jsx("h2",{className:"font-semibold text-xl text-slate-800 leading-tight",children:"Registrar Recibo de Pago"}),children:[e.jsx(j,{title:"Nuevo Cobro"}),e.jsx("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-slate-900 text-white flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold uppercase text-sm tracking-wider",children:"1. Seleccione facturas pendientes"}),e.jsxs("span",{className:"bg-blue-500 px-3 py-1 rounded-full text-xs font-black",children:[s.facturas_ids.length," Seleccionadas"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase",children:"Sel."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase",children:"Factura"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-bold text-slate-500 uppercase",children:"Saldo Pendiente"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"p-10 text-center text-slate-500 italic",children:"No hay facturas con saldo pendiente actualmente."})}):r.map(t=>{var d;return e.jsxs("tr",{className:`transition cursor-pointer ${s.facturas_ids.includes(t.id)?"bg-blue-50":"hover:bg-slate-50"}`,onClick:()=>x(t.id,t.saldo_pendiente),children:[e.jsx("td",{className:"px-6 py-4",onClick:c=>c.stopPropagation(),children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-5 w-5 cursor-pointer",onChange:()=>x(t.id,t.saldo_pendiente),checked:s.facturas_ids.includes(t.id)})}),e.jsx("td",{className:"px-6 py-4 font-mono font-bold text-slate-900",children:t.numero_factura}),e.jsx("td",{className:"px-6 py-4 text-slate-700",children:(d=t.cliente)==null?void 0:d.razon_social}),e.jsx("td",{className:"px-6 py-4 text-right font-black text-slate-900",children:n(t.saldo_pendiente)})]},t.id)})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-600 rounded-lg p-6 shadow-md text-white md:col-span-1 flex flex-col justify-center",children:[e.jsx("div",{className:"text-sm font-bold uppercase opacity-80",children:"Monto Total a Recibir"}),e.jsx("div",{className:"text-4xl font-black mt-2",children:n(s.monto_total)}),e.jsxs("div",{className:"text-xs mt-2 italic text-blue-100",children:["Liquidación total de ",s.facturas_ids.length," documento(s)"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-slate-200 md:col-span-2 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2 md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 uppercase mb-1",children:"Banco de Destino"}),e.jsxs("select",{className:"w-full border-slate-200 rounded-lg focus:ring-blue-500",value:s.bank_account_id,onChange:t=>l("bank_account_id",t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Seleccionar Banco --"}),p.map(t=>e.jsxs("option",{value:t.id,children:[t.nombre_banco," (Saldo: ",n(t.saldo_actual),")"]},t.id))]}),o.bank_account_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1 font-bold",children:o.bank_account_id})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 uppercase mb-1",children:"Método de Pago"}),e.jsxs("select",{className:"w-full border-slate-200 rounded-lg focus:ring-blue-500",value:s.metodo_pago,onChange:t=>l("metodo_pago",t.target.value),children:[e.jsx("option",{value:"Transferencia",children:"Transferencia / ACH"}),e.jsx("option",{value:"Cheque",children:"Cheque"}),e.jsx("option",{value:"Efectivo",children:"Efectivo"}),e.jsx("option",{value:"Tarjeta",children:"Tarjeta"})]})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 uppercase mb-1",children:"Referencia / # Documento"}),e.jsx("input",{type:"text",className:"w-full border-slate-200 rounded-lg focus:ring-blue-500",value:s.referencia,onChange:t=>l("referencia",t.target.value),placeholder:"Ej: CHQ-505 o ACH-9921"})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 uppercase mb-1",children:"Fecha de Recibo"}),e.jsx("input",{type:"date",className:"w-full border-slate-200 rounded-lg focus:ring-blue-500",value:s.fecha_pago,onChange:t=>l("fecha_pago",t.target.value),required:!0})]})]})]}),e.jsx("button",{type:"submit",disabled:i||s.facturas_ids.length===0,className:"w-full bg-slate-900 text-white py-4 rounded-lg font-black text-lg hover:bg-slate-800 transition shadow-lg disabled:bg-slate-300 disabled:cursor-not-allowed uppercase tracking-widest",children:i?"Registrando Movimiento...":`Confirmar Cobro de ${n(s.monto_total)}`}),o.monto_total&&e.jsx("p",{className:"text-red-600 text-center font-bold",children:o.monto_total})]})})]})}export{y as default};
