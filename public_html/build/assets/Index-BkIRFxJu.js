import{r as o,u as P,j as e,H as I}from"./app-B9gv8ZBn.js";import{A as L}from"./AuthenticatedLayout-BtVr5BZh.js";function M(){const[b,m]=o.useState([]),[j,h]=o.useState([]),[i,d]=o.useState(null),{data:t,setData:a,post:f,put:v,processing:N,reset:p,errors:g}=P({es_para_nesting:!1,es_insumo:!1,requires_recipe:!1,tipo_impresion:"",ancho_imprimible:"",largo_imprimible:"",permite_rotacion:!0,separacion_piezas:.5,sangrado:.3,procesos_ids:[],papeles_ids:[]}),[k,_]=o.useState([]),[y,w]=o.useState([]),[x,c]=o.useState("basico");o.useEffect(()=>{u()},[]);const u=()=>{fetch("/api/inventario/items").then(s=>s.json()).then(s=>{m(s.items||[]),h(s.taxes||[]),_(s.procesos||[]),w(s.papeles||[]),(s.taxes||[]).length>0&&!i&&a("tax_id",s.taxes[0].id)}).catch(s=>{console.error("Error loading items:",s),m([]),h([])})},C=s=>{s.preventDefault(),i?v(`/inventario/items/${i}`,{onSuccess:()=>{p(),d(null),u()}}):f("/inventario/items",{onSuccess:()=>{p(),u()}})},S=s=>{var l,n;a({...s,procesos_ids:((l=s.procesos_compatibles)==null?void 0:l.map(r=>r.id))||[],papeles_ids:((n=s.papeles_compatibles)==null?void 0:n.map(r=>r.id))||[]}),d(s.id),c("basico")},q=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s);return e.jsxs(L,{children:[e.jsx(I,{title:"Gestión de Inventario"}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-black text-slate-900 flex items-center gap-3",children:[e.jsx("svg",{className:"w-8 h-8 text-slate-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"Gestión de Inventario"]}),e.jsx("p",{className:"text-slate-600 mt-2",children:"Productos y servicios del catálogo"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("form",{onSubmit:C,className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200 h-fit",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-800 mb-4",children:i?"Editar Item":"Nuevo Item"}),e.jsxs("div",{className:"flex border-b border-slate-200 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>c("basico"),className:`px-4 py-2 text-xs font-black uppercase tracking-widest ${x==="basico"?"border-b-2 border-blue-600 text-blue-600":"text-slate-400"}`,children:"Básico"}),e.jsxs("button",{type:"button",onClick:()=>c("produccion"),className:`px-4 py-2 text-xs font-black uppercase tracking-widest ${x==="produccion"?"border-b-2 border-blue-600 text-blue-600":"text-slate-400"}`,children:["Producción ",t.requires_recipe&&e.jsx("span",{className:"ml-1 w-2 h-2 bg-green-500 rounded-full inline-block"})]})]}),x==="basico"?e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-left-2 transition-all duration-300",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"Código / SKU"}),e.jsx("input",{type:"text",value:t.codigo,onChange:s=>a("codigo",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-blue-500 transition shadow-sm",placeholder:"PROD-001",required:!0}),g.codigo&&e.jsx("span",{className:"text-red-500 text-xs font-bold",children:g.codigo})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"Nombre del Producto"}),e.jsx("input",{type:"text",value:t.nombre,onChange:s=>a("nombre",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-blue-500 transition shadow-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"Tipo"}),e.jsxs("select",{value:t.tipo,onChange:s=>a("tipo",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-blue-500 transition font-bold shadow-sm",children:[e.jsx("option",{value:"Inventariable",children:"Producto Físico"}),e.jsx("option",{value:"Servicio",children:"Servicio"}),e.jsx("option",{value:"Materia Prima",children:"Materia Prima / Material"}),e.jsx("option",{value:"Producto Terminado",children:"Producto Terminado"}),e.jsx("option",{value:"Consumible",children:"Consumible"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"Precio Venta"}),e.jsx("input",{type:"number",step:"0.01",value:t.precio_venta,onChange:s=>a("precio_venta",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-blue-500 transition font-bold",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"Costo"}),e.jsx("input",{type:"number",step:"0.01",value:t.costo_promedio,onChange:s=>a("costo_promedio",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-blue-500 transition font-bold",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"Impuesto"}),e.jsx("select",{value:t.tax_id,onChange:s=>a("tax_id",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-blue-500 transition font-bold",required:!0,children:j.map(s=>e.jsxs("option",{value:s.id,children:[s.nombre," (",s.tasa,"%)"]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"Unidad"}),e.jsxs("select",{value:t.unidad_medida,onChange:s=>a("unidad_medida",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-blue-500 transition font-bold",children:[e.jsx("option",{value:"UND",children:"Unidad"}),e.jsx("option",{value:"KG",children:"Kilogramo"}),e.jsx("option",{value:"LT",children:"Litro"}),e.jsx("option",{value:"MT",children:"Metro"})]})]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl space-y-4 border border-slate-200",children:[e.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest border-b pb-2",children:"Opciones de Sistema"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"es_para_nesting",checked:t.es_para_nesting,onChange:s=>a("es_para_nesting",s.target.checked),className:"w-4 h-4 rounded border-slate-300 text-green-600 focus:ring-green-500"}),e.jsx("label",{htmlFor:"es_para_nesting",className:"text-xs font-black text-slate-700 uppercase cursor-pointer",children:"Disponible para Nesting / Pliegos"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"es_insumo",checked:t.es_insumo,onChange:s=>a("es_insumo",s.target.checked),className:"w-4 h-4 rounded border-slate-300 text-orange-600 focus:ring-orange-500"}),e.jsx("label",{htmlFor:"es_insumo",className:"text-xs font-black text-slate-700 uppercase cursor-pointer",children:"Es Insumo (No venta al público)"})]})]})]})]}):e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-2 transition-all duration-300",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-2xl border border-blue-100 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"requires_recipe",checked:t.requires_recipe,onChange:s=>a("requires_recipe",s.target.checked),className:"w-5 h-5 rounded-lg border-blue-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"requires_recipe",className:"font-black text-sm text-blue-900 uppercase",children:"¿Este producto requiere receta de producción?"})]}),e.jsx("p",{className:"text-[10px] text-blue-600 font-bold mt-2 uppercase",children:"Activa esto para configurar máquinas, dimensiones y nesting inteligente."})]}),t.requires_recipe&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black uppercase text-slate-500 mb-2",children:"Tipo de Impresión / Tecnología"}),e.jsxs("select",{value:t.tipo_impresion,onChange:s=>a("tipo_impresion",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-blue-500 transition font-black bg-white",required:t.requires_recipe,children:[e.jsx("option",{value:"",children:"Seleccione tecnología..."}),e.jsx("option",{value:"Sublimación",children:"Sublimación"}),e.jsx("option",{value:"Láser",children:"Láser (Tóner)"}),e.jsx("option",{value:"Offset",children:"Offset"}),e.jsx("option",{value:"UV",children:"Cama Plana UV"}),e.jsx("option",{value:"Otros",children:"Otros"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black uppercase text-slate-500 mb-2",children:"Ancho Fijo (cm)"}),e.jsx("input",{type:"number",step:"0.01",value:t.ancho_imprimible,onChange:s=>a("ancho_imprimible",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 font-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black uppercase text-slate-500 mb-2",children:"Alto Fijo (cm)"}),e.jsx("input",{type:"number",step:"0.01",value:t.largo_imprimible,onChange:s=>a("largo_imprimible",s.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-300 font-black"})]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-2xl border border-slate-200 space-y-4",children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-slate-400",children:"Reglas de Nesting"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"permite_rotacion",checked:t.permite_rotacion,onChange:s=>a("permite_rotacion",s.target.checked),className:"w-4 h-4 rounded border-slate-300 text-blue-600"}),e.jsx("label",{htmlFor:"permite_rotacion",className:"text-xs font-black uppercase text-slate-700",children:"Permitir rotación para optimizar"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-500 mb-1",children:"Separación (cm)"}),e.jsx("input",{type:"number",step:"0.01",value:t.separacion_piezas,onChange:s=>a("separacion_piezas",s.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-300 text-xs font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-500 mb-1",children:"Sangrado (cm)"}),e.jsx("input",{type:"number",step:"0.01",value:t.sangrado,onChange:s=>a("sangrado",s.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-300 text-xs font-bold"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-black uppercase text-slate-500 mb-2",children:["Máquinas Compatibles (",t.tipo_impresion||"Todas",")"]}),e.jsx("div",{className:"max-h-32 overflow-y-auto border border-slate-200 rounded-lg p-2 bg-white space-y-1",children:k.filter(s=>{var l;return!t.tipo_impresion||s.tipo_maquina.includes(t.tipo_impresion)||((l=s.categoria_tecnologia)==null?void 0:l.includes(t.tipo_impresion))}).map(s=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1 hover:bg-slate-50 rounded cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:t.procesos_ids.includes(s.id),onChange:l=>{const n=l.target.checked?[...t.procesos_ids,s.id]:t.procesos_ids.filter(r=>r!==s.id);a("procesos_ids",n)},className:"w-4 h-4 rounded border-slate-300 text-blue-600"}),e.jsx("span",{className:"text-xs font-bold text-slate-700",children:s.nombre})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black uppercase text-slate-500 mb-2",children:"Papeles / Soportes Compatibles"}),e.jsx("div",{className:"max-h-32 overflow-y-auto border border-slate-200 rounded-lg p-2 bg-white space-y-1",children:y.map(s=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1 hover:bg-slate-50 rounded cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:t.papeles_ids.includes(s.id),onChange:l=>{const n=l.target.checked?[...t.papeles_ids,s.id]:t.papeles_ids.filter(r=>r!==s.id);a("papeles_ids",n)},className:"w-4 h-4 rounded border-slate-300 text-blue-600"}),e.jsx("span",{className:"text-xs font-bold text-slate-700",children:s.nombre})]},s.id))})]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-8 pt-6 border-t border-slate-100",children:[e.jsx("button",{type:"submit",disabled:N,className:"flex-1 px-6 py-4 bg-slate-900 text-white rounded-xl font-black uppercase tracking-tighter hover:bg-blue-600 transition disabled:opacity-50 shadow-lg shadow-slate-900/10",children:i?"Actualizar Producto":"Registrar Producto"}),i&&e.jsx("button",{type:"button",onClick:()=>{p(),d(null),c("basico")},className:"px-6 py-4 bg-slate-100 text-slate-500 rounded-xl font-black uppercase tracking-tighter hover:bg-slate-200 transition",children:"Cancelar"})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-slate-50 border-b border-slate-200",children:e.jsx("input",{type:"text",placeholder:"Buscar por código o nombre...",className:"w-full px-4 py-2 rounded-lg border border-slate-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-900 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold uppercase",children:"Código"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold uppercase",children:"Nombre"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-bold uppercase",children:"Stock"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-bold uppercase",children:"Precio"}),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-bold uppercase",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:b.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",className:"px-6 py-12 text-center text-slate-500",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),e.jsx("p",{className:"text-lg font-bold",children:"No hay productos registrados"}),e.jsx("p",{className:"text-sm mt-2",children:"Comienza agregando tu primer producto"})]})}):b.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 transition",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("span",{className:"font-mono font-bold text-slate-900",children:s.codigo}),s.es_para_nesting&&e.jsx("span",{className:"block text-[8px] bg-green-100 text-green-700 px-1 rounded-full text-center mt-1 font-black",children:"NESTING"})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-slate-900",children:s.nombre}),e.jsx("div",{className:"text-[10px] text-slate-500 uppercase font-black tracking-widest",children:s.categoria||"Sin categoría"}),e.jsxs("div",{className:"flex gap-1 mt-1",children:[s.es_insumo&&e.jsx("span",{className:"text-[8px] bg-orange-100 text-orange-600 px-1.5 py-0.5 rounded font-black uppercase",children:"Insumo"}),s.requires_recipe&&e.jsx("span",{className:"text-[8px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded font-black uppercase",children:"Con Receta"}),s.tipo_impresion&&e.jsx("span",{className:"text-[8px] bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded font-black uppercase",children:s.tipo_impresion})]})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:s.tipo!=="Servicio"?e.jsxs("span",{className:`font-bold ${s.stock_actual<=s.stock_minimo?"text-red-600":"text-slate-900"}`,children:[s.stock_actual," ",s.unidad_medida]}):e.jsx("span",{className:"text-slate-400 text-sm",children:"N/A"})}),e.jsx("td",{className:"px-6 py-4 text-right text-blue-600 font-bold",children:q(s.precio_venta)}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("button",{onClick:()=>S(s),className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition font-bold text-sm inline-flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Editar"]})})]},s.id))})]})})]})]})]})]})}export{M as default};
